Turbo Assembler	 Version 4.1	    02/25/23 03:47:43	    Page 1
main.asm



      1	0000			     .model tiny
      2	0000			     .code
      3
      4				     org 100h
      5
      6				     locals @@
      7
      8	0100  BE 02AEr		     Start:  mov si, offset cmd				     ; will be 80h
      9	0103  46			     inc si
     10
     11	0104  32 E4			     xor ah, ah
     12
     13	0106  AC			     lodsb
     14	0107  8B F8			     mov di, ax					     ; x of lt
     15	0109  03 FF			     add di, di
     16
     17	010B  AC			     lodsb					     ; y of lt
     18	010C  B3 A0			     mov bl, 80	* 2
     19	010E  F6 E3			     mul bl
     20
     21	0110  03 F8			     add di, ax					     ; now di is start of border
     22
     23	0112  AC			     lodsb
     24	0113  D1 E0 D1 E0 D1 E0	D1+	     shl ax, 8
     25	      E0 D1 E0 D1 E0 D1	E0+
     26	      D1 E0
     27
     28	0123  AC			     lodsb
     29	0124  8B D0			     mov dx, ax					     ; dh is height, dl	is width
     30
     31	0126  AC			     lodsb
     32	0127  8A E0			     mov ah, al
     33
     34	0129  AC			     lodsb
     35
     36	012A  33 DB			     xor bx, bx
     37
     38					     REPT 9
     39					     add bl, al
     40					     ENDM
1    41	012C  02 D8			     add bl, al
1    42	012E  02 D8			     add bl, al
1    43	0130  02 D8			     add bl, al
1    44	0132  02 D8			     add bl, al
1    45	0134  02 D8			     add bl, al
1    46	0136  02 D8			     add bl, al
1    47	0138  02 D8			     add bl, al
1    48	013A  02 D8			     add bl, al
1    49	013C  02 D8			     add bl, al
     50
     51	013E  81 C3 02CCr		     add bx, offset cbrd
     52
     53	0142  3C 00			     cmp al, 0
     54	0144  75 24			     jne to_vm
     55
     56					     REPT 9
     57					     lodsb
Turbo Assembler	 Version 4.1	    02/25/23 03:47:43	    Page 2
main.asm



     58
     59					     mov [bx], al
     60
     61					     inc bx
     62					     ENDM
1    63	0146  AC			     lodsb
1    64
1    65	0147  88 07			     mov [bx], al
1    66
1    67	0149  43			     inc bx
1    68	014A  AC			     lodsb
1    69
1    70	014B  88 07			     mov [bx], al
1    71
1    72	014D  43			     inc bx
1    73	014E  AC			     lodsb
1    74
1    75	014F  88 07			     mov [bx], al
1    76
1    77	0151  43			     inc bx
1    78	0152  AC			     lodsb
1    79
1    80	0153  88 07			     mov [bx], al
1    81
1    82	0155  43			     inc bx
1    83	0156  AC			     lodsb
1    84
1    85	0157  88 07			     mov [bx], al
1    86
1    87	0159  43			     inc bx
1    88	015A  AC			     lodsb
1    89
1    90	015B  88 07			     mov [bx], al
1    91
1    92	015D  43			     inc bx
1    93	015E  AC			     lodsb
1    94
1    95	015F  88 07			     mov [bx], al
1    96
1    97	0161  43			     inc bx
1    98	0162  AC			     lodsb
1    99
1   100	0163  88 07			     mov [bx], al
1   101
1   102	0165  43			     inc bx
1   103	0166  AC			     lodsb
1   104
1   105	0167  88 07			     mov [bx], al
1   106
1   107	0169  43			     inc bx
    108
    109	016A  8B F3		      to_vm: mov si, bx
    110
    111	016C  BB B800			     mov bx, 0B800h
    112	016F  8E C3			     mov es, bx
    113
    114	0171  E8 00DC			     call Border
Turbo Assembler	 Version 4.1	    02/25/23 03:47:43	    Page 3
main.asm



    115
    116	0174  8B DA			     mov bx, dx
    117	0176  32 FF			     xor bh, bh
    118
    119	0178  2B FB			     sub di, bx
    120	017A  D1 EA D1 EA D1 EA	D1+	     shr dx, 8
    121	      EA D1 EA D1 EA D1	EA+
    122	      D1 EA
    123					     REPT 80
    124					     sub di, dx
    125					     ENDM
1   126	018A  2B FA			     sub di, dx
1   127	018C  2B FA			     sub di, dx
1   128	018E  2B FA			     sub di, dx
1   129	0190  2B FA			     sub di, dx
1   130	0192  2B FA			     sub di, dx
1   131	0194  2B FA			     sub di, dx
1   132	0196  2B FA			     sub di, dx
1   133	0198  2B FA			     sub di, dx
1   134	019A  2B FA			     sub di, dx
1   135	019C  2B FA			     sub di, dx
1   136	019E  2B FA			     sub di, dx
1   137	01A0  2B FA			     sub di, dx
1   138	01A2  2B FA			     sub di, dx
1   139	01A4  2B FA			     sub di, dx
1   140	01A6  2B FA			     sub di, dx
1   141	01A8  2B FA			     sub di, dx
1   142	01AA  2B FA			     sub di, dx
1   143	01AC  2B FA			     sub di, dx
1   144	01AE  2B FA			     sub di, dx
1   145	01B0  2B FA			     sub di, dx
1   146	01B2  2B FA			     sub di, dx
1   147	01B4  2B FA			     sub di, dx
1   148	01B6  2B FA			     sub di, dx
1   149	01B8  2B FA			     sub di, dx
1   150	01BA  2B FA			     sub di, dx
1   151	01BC  2B FA			     sub di, dx
1   152	01BE  2B FA			     sub di, dx
1   153	01C0  2B FA			     sub di, dx
1   154	01C2  2B FA			     sub di, dx
1   155	01C4  2B FA			     sub di, dx
1   156	01C6  2B FA			     sub di, dx
1   157	01C8  2B FA			     sub di, dx
1   158	01CA  2B FA			     sub di, dx
1   159	01CC  2B FA			     sub di, dx
1   160	01CE  2B FA			     sub di, dx
1   161	01D0  2B FA			     sub di, dx
1   162	01D2  2B FA			     sub di, dx
1   163	01D4  2B FA			     sub di, dx
1   164	01D6  2B FA			     sub di, dx
1   165	01D8  2B FA			     sub di, dx
1   166	01DA  2B FA			     sub di, dx
1   167	01DC  2B FA			     sub di, dx
1   168	01DE  2B FA			     sub di, dx
1   169	01E0  2B FA			     sub di, dx
1   170	01E2  2B FA			     sub di, dx
1   171	01E4  2B FA			     sub di, dx
Turbo Assembler	 Version 4.1	    02/25/23 03:47:43	    Page 4
main.asm



1   172	01E6  2B FA			     sub di, dx
1   173	01E8  2B FA			     sub di, dx
1   174	01EA  2B FA			     sub di, dx
1   175	01EC  2B FA			     sub di, dx
1   176	01EE  2B FA			     sub di, dx
1   177	01F0  2B FA			     sub di, dx
1   178	01F2  2B FA			     sub di, dx
1   179	01F4  2B FA			     sub di, dx
1   180	01F6  2B FA			     sub di, dx
1   181	01F8  2B FA			     sub di, dx
1   182	01FA  2B FA			     sub di, dx
1   183	01FC  2B FA			     sub di, dx
1   184	01FE  2B FA			     sub di, dx
1   185	0200  2B FA			     sub di, dx
1   186	0202  2B FA			     sub di, dx
1   187	0204  2B FA			     sub di, dx
1   188	0206  2B FA			     sub di, dx
1   189	0208  2B FA			     sub di, dx
1   190	020A  2B FA			     sub di, dx
1   191	020C  2B FA			     sub di, dx
1   192	020E  2B FA			     sub di, dx
1   193	0210  2B FA			     sub di, dx
1   194	0212  2B FA			     sub di, dx
1   195	0214  2B FA			     sub di, dx
1   196	0216  2B FA			     sub di, dx
1   197	0218  2B FA			     sub di, dx
1   198	021A  2B FA			     sub di, dx
1   199	021C  2B FA			     sub di, dx
1   200	021E  2B FA			     sub di, dx
1   201	0220  2B FA			     sub di, dx
1   202	0222  2B FA			     sub di, dx
1   203	0224  2B FA			     sub di, dx
1   204	0226  2B FA			     sub di, dx
1   205	0228  2B FA			     sub di, dx
    206
    207	022A  BE 02AEr			     mov si, offset cmd				     ; will be 80h
    208	022D  32 ED			     xor ch, ch
    209	022F  8A 0C			     mov cl, [si]
    210
    211	0231  8B 5C 06			     mov bx, [si + 6]
    212
    213	0234  80 FB 00			     cmp bl, 0
    214
    215	0237  75 03			     jne ncbrd
    216
    217				     ;	      sub cl, 9
    218	0239  83 C6 09			     add si, 9
    219
    220	023C  80 E9 06		     ncbrd:  sub cl, 6
    221
    222	023F  2B F9			     sub di, cx
    223	0241  83 E7 FE			     and di, 0FFFEh
    224
    225	0244  83 C6 07			     add si, 7				; will be 87h
    226
    227	0247  AC		     @@Next: lodsb
    228	0248  AB			     stosw
Turbo Assembler	 Version 4.1	    02/25/23 03:47:43	    Page 5
main.asm



    229
    230	0249  E2 FC			     loop @@Next
    231
    232	024B  B8 4C00			     mov ax, 4C00h
    233	024E  CD 21			     int 21h
    234
    235				     include bordre.asi
1   236				     ;
1   237				     ; args - ah, di, dl, si
1   238				     ; ah - attribute
1   239				     ; di - start
1   240				     ; dl - width
1   241				     ; si - border source
1   242				     ; dh - height
1   243				     ; destroys	- dohuya
1   244				     ;
1   245
1   246	0250			     Border  proc
1   247	0250  55			     push bp
1   248
1   249	0251  E8 0045			     call String
1   250
1   251	0254  81 C7 00A0		     add di, 80	* 2
1   252
1   253	0258  32 FF			     xor bh, bh		     ; cringe
1   254	025A  8A DA			     mov bl, dl
1   255
1   256	025C  2B FB			     sub di, bx
1   257	025E  2B FB			     sub di, bx
1   258
1   259	0260  8B EA			     mov bp, dx
1   260	0262  81 E5 FF00		     and bp, 0FF00h
1   261	0266  D1 ED D1 ED D1 ED	D1+	     shr bp, 8
    262	      ED D1 ED D1 ED D1	ED+
    263	      D1 ED
1   264	0276  83 ED 02			     sub bp, 2
1   265
1   266	0279  E8 001D		     zaloop: call String
1   267
1   268	027C  83 EE 03			     sub si, 3
1   269
1   270	027F  81 C7 00A0		     add di, 80	* 2
1   271
1   272	0283  32 FF			     xor bh, bh		     ; cringe
1   273	0285  8A DA			     mov bl, dl
1   274
1   275	0287  2B FB			     sub di, bx
1   276	0289  2B FB			     sub di, bx
1   277
1   278	028B  4D			     dec bp
1   279
1   280	028C  83 FD 00			     cmp bp, 0
1   281	028F  75 E8			     jne zaloop
1   282
1   283	0291  83 C6 03			     add si, 3
1   284
1   285	0294  E8 0002			     call String
Turbo Assembler	 Version 4.1	    02/25/23 03:47:43	    Page 6
main.asm



1   286
1   287	0297  5D			     pop bp
1   288	0298  C3			     ret
1   289	0299				     endp
1   290
1   291					     include string.asi
2   292				     ;
2   293				     ; args - ah, di, dl
2   294				     ; ah - attribute
2   295				     ; di - start
2   296				     ; dl - length
2   297				     ; destroys	- si, cx
2   298				     ;
2   299
2   300	0299			     String  proc
2   301
2   302	0299  AC			     lodsb
2   303	029A  AB			     stosw
2   304
2   305	029B  AC			     lodsb
2   306
2   307	029C  8A CA			     mov cl, dl
2   308	029E  80 E9 02			     sub cl, 2
2   309	02A1  32 ED			     xor ch, ch
2   310
2   311	02A3  26: 89 05		     @@Next: mov es:[di], ax
2   312
2   313	02A6  83 C7 02			     add di, 2
2   314
2   315	02A9  E2 F8			     loop @@Next
2   316
2   317	02AB  AC			     lodsb
2   318	02AC  AB			     stosw
2   319
2   320	02AD  C3			     ret
2   321	02AE				     endp
    322
    323	02AE  14 03 03 08 41 1E	00+  cmd     db	14h, 3,	3, 8, 65, 01Eh,	0, 40h,	40h, 40h, 40h, 00h, 40h, 40h, 40h, 40h,	'i hate	    +
    324	      40 40 40 40 00 40	40+  niggers'
    325	      40 40 69 20 68 61	74+
    326	      65 20 6E 69 67 67	65+
    327	      72 73
    328
    329	02CC  ?? ?? ?? ?? ?? ??	??+  cbrd    db	  ?,   ?,   ?,	 ?,   ?,   ?,	?,   ?,	  ?  ; custom border
    330	      ?? ??
    331	02D5  40 40 40 40 00 40	40+  brd1    db	40h, 40h, 40h, 40h, 00h, 40h, 40h, 40h,	40h
    332	      40 40
    333	02DE  40 40 40 40 00 40	40+  brd2    db	40h, 40h, 40h, 40h, 00h, 40h, 40h, 40h,	40h
    334	      40 40
    335	02E7  40 40 40 40 00 40	40+  brd3    db	40h, 40h, 40h, 40h, 00h, 40h, 40h, 40h,	40h
    336	      40 40
    337	02F0  40 40 40 40 00 40	40+  brd4    db	40h, 40h, 40h, 40h, 00h, 40h, 40h, 40h,	40h
    338	      40 40
    339	02F9  40 40 40 40 00 40	40+  brd5    db	40h, 40h, 40h, 40h, 00h, 40h, 40h, 40h,	40h
    340	      40 40
    341
    342				     end     Start
Turbo Assembler	 Version 4.1	    02/25/23 03:47:43	    Page 7
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/25/23"
??FILENAME			  Text	 "main	  "
??TIME				  Text	 "03:47:42"
??VERSION			  Number 040A
@32BIT				  Text	 0
@@NEXT				  Near	 DGROUP:0247
@@NEXT				  Near	 DGROUP:02A3
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 MAIN
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
BORDER				  Near	 DGROUP:0250
BRD1				  Byte	 DGROUP:02D5
BRD2				  Byte	 DGROUP:02DE
BRD3				  Byte	 DGROUP:02E7
BRD4				  Byte	 DGROUP:02F0
BRD5				  Byte	 DGROUP:02F9
CBRD				  Byte	 DGROUP:02CC
CMD				  Byte	 DGROUP:02AE
NCBRD				  Near	 DGROUP:023C
START				  Near	 DGROUP:0100
STRING				  Near	 DGROUP:0299
TO_VM				  Near	 DGROUP:016A
ZALOOP				  Near	 DGROUP:0279

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  0302 Word	  Public  CODE
